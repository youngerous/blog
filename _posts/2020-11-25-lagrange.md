---
title: "Lagrange Multiplier"
categories: 
  - optimization
last_modified_at: 2020-11-25
tags:
  - lagrangian
toc: true
use_math: true
---

# Lagrange Multiplier(라그랑주 승수법)

## 직관적 흐름

어떠한 함수의 최적점(최댓값 혹은 최솟값)을 찾아야 한다. 다만, 등식 혹은 부등식 제약조건이 존재한다.


간단한 예시로 $f(x,y)=x^2y$의 함수와 $x^2+y^2=1$이라는 제약조건이 있을 때, 최적점은 접점(tangent)에서 발생한다. 여기서 최적화를 위해서는 Gradient Vector를 이용하는데, Gradient Vector는 접선벡터와 수직(perpendicular)이다([참고자료](https://m.blog.naver.com/PostView.nhn?blogId=mindo1103&logNo=90153612595&proxyReferer=https:%2F%2Fwww.google.com%2F)). 


따라서 아래와 같이 정리할 수 있다.

- 함수 $f(x,y)=x^2y$ 위 한 점에서의 Gradient Vector는 해당 점에서의 접선벡터와 수직이다.
- 제약조건 $x^2+y^2=1$ 위 한 점에서의 Gradient Vector는 해당 점에서의 접선벡터와 수직이다.
- 따라서 함수와 제약조건의 접점에서 Gradient Vector를 구하면, 두 Gradient Vector의 방향은 같다(길이가 같다는 보장은 없지만 상수배로 표현할 수 있다).


이를 식으로 표현하면 아래와 같다. $\lambda$로 표현되는 상수를 Lagrange Multiplier라고 부른다.

$$ \nabla f(x_m, y_m) = \lambda \nabla g(x_m, y_m) \;\; \cdots \;\; ①$$


위의 예시를 그대로 사용하여 gradient를 구해보자.

$$ \nabla f = \nabla (x^2y) = \begin{bmatrix}
2xy \\
x^2
\end{bmatrix} $$


$$ \nabla g = \nabla (x^2+y^2) = \begin{bmatrix}
2x \\
2y
\end{bmatrix} $$


식 ①에 따르면 이 둘의 관계는 아래와 같이 표현할 수 있다. 

$$ 2xy = \lambda 2x $$

$$ x^2 = \lambda 2y $$

미지수가 총 3개($x, y, \lambda$)이기 때문에 방정식이 하나 더 필요한데, 처음의 제약식($x^2+y^2=1$)을 사용하면 된다.




## 참고 
- [Khan Academy: Lagrange multipliers and constrained optimization](https://www.khanacademy.org/math/multivariable-calculus/applications-of-multivariable-derivatives/lagrange-multipliers-and-constrained-optimization/v/constrained-optimization-introduction)
- [기울기 벡터(Gradient Vector)의 기하학적 의미](https://m.blog.naver.com/PostView.nhn?blogId=mindo1103&logNo=90153612595&proxyReferer=https:%2F%2Fwww.google.com%2F)
  